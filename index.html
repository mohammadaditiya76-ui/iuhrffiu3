<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kue Smargon Tata Boga - Toko Online</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Konfigurasi Font Inter -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            color: #333;
        }
        /* Style kustom untuk admin panel */
        .admin-modal-backdrop {
            background-color: rgba(0, 0, 0, 0.7);
        }
        .main-color { background-color: #ff99aa; }
        .text-main-color { color: #ff99aa; }
    </style>
</head>
<body>

    <!-- Header & Navigasi -->
    <header class="shadow-lg main-color sticky top-0 z-10">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-3xl font-bold text-white tracking-wider">SMARGON</h1>
            <nav class="hidden md:flex space-x-6 text-white font-medium">
                <a href="#beranda" class="hover:underline">Beranda</a>
                <a href="#produk" class="hover:underline">Produk</a>
                <a href="#kontak" class="hover:underline">Kontak</a>
                <button id="admin-button" class="bg-white text-main-color px-3 py-1 rounded-full text-sm font-semibold hover:bg-gray-100 transition duration-300">Admin</button>
            </nav>
            <button class="md:hidden text-white text-2xl" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">‚ò∞</button>
        </div>
        <!-- Menu Mobile -->
        <div id="mobile-menu" class="hidden md:hidden main-color pb-2">
            <a href="#beranda" class="block px-4 py-2 text-white hover:bg-pink-400">Beranda</a>
            <a href="#produk" class="block px-4 py-2 text-white hover:bg-pink-400">Produk</a>
            <a href="#kontak" class="block px-4 py-2 text-white hover:bg-pink-400">Kontak</a>
            <button id="admin-button-mobile" class="w-full text-left px-4 py-2 text-white bg-pink-600 hover:bg-pink-700">Admin</button>
        </div>
    </header>

    <main>
        <!-- Loading Indicator -->
        <div id="loading-screen" class="fixed inset-0 flex items-center justify-center bg-white z-50">
            <div class="flex flex-col items-center">
                <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-main-color"></div>
                <p class="mt-4 text-lg text-gray-600">Memuat konten...</p>
            </div>
        </div>

        <!-- Bagian Beranda & Slideshow -->
        <section id="beranda" class="relative overflow-hidden pt-16" style="min-height: 80vh;">
            <div id="slideshow-container" class="relative h-full transition-all duration-500 ease-in-out">
                <!-- Slides akan diisi oleh JavaScript -->
            </div>
            <!-- Navigasi Slideshow -->
            <button class="absolute top-1/2 left-4 transform -translate-y-1/2 bg-black bg-opacity-30 text-white p-3 rounded-full hover:bg-opacity-50 transition" onclick="changeSlide(-1)">‚ùÆ</button>
            <button class="absolute top-1/2 right-4 transform -translate-y-1/2 bg-black bg-opacity-30 text-white p-3 rounded-full hover:bg-opacity-50 transition" onclick="changeSlide(1)">‚ùØ</button>
            
            <div id="slide-dots" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                <!-- Dots akan diisi oleh JavaScript -->
            </div>
        </section>

        <!-- Bagian Produk -->
        <section id="produk" class="container mx-auto px-4 py-16">
            <h2 class="text-5xl font-extrabold text-center mb-12 text-main-color">Produk Smargon Terbaik</h2>
            <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Daftar produk akan diisi oleh JavaScript -->
            </div>
        </section>

        <!-- Bagian Tentang Kami (Opsional, untuk menambahkan teks intro) -->
        <section id="tentang" class="main-color py-16">
            <div class="container mx-auto px-4 text-center text-white">
                <h2 class="text-4xl font-bold mb-6">Tentang Kue Smargon Tata Boga</h2>
                <p id="about-text" class="text-lg leading-relaxed max-w-3xl mx-auto">
                    <!-- Teks tentang akan diisi oleh JavaScript -->
                </p>
            </div>
        </section>

        <!-- Bagian Kontak -->
        <section id="kontak" class="container mx-auto px-4 py-16">
            <h2 class="text-4xl font-bold text-center mb-12 text-main-color">Hubungi Kami</h2>
            <div class="max-w-xl mx-auto p-8 bg-white shadow-xl rounded-xl">
                <div id="contact-info" class="space-y-4 text-lg">
                    <!-- Informasi kontak akan diisi oleh JavaScript -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2025 Kue Smargon Tata Boga. Hak Cipta Dilindungi.</p>
        </div>
    </footer>

    <!-- Admin Panel Modal -->
    <div id="admin-modal" class="fixed inset-0 admin-modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div id="admin-content" class="bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6 transition-all duration-300 transform scale-95 opacity-0">
            <h3 class="text-3xl font-bold text-main-color border-b pb-3 mb-6">Panel Admin Konten</h3>
            
            <!-- Area Otentikasi -->
            <div id="auth-area" class="space-y-4">
                <label for="admin-password" class="block text-lg font-medium text-gray-700">Masukkan Kata Sandi Admin:</label>
                <input type="password" id="admin-password" placeholder="Kata sandi" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-main-color focus:border-main-color">
                <p id="auth-error" class="text-red-500 hidden">Kata sandi salah. Coba lagi.</p>
                <div class="flex justify-between items-center">
                    <button id="login-button" class="main-color text-white px-5 py-2 rounded-lg font-semibold hover:bg-pink-600 transition">Masuk</button>
                    <button onclick="closeAdminModal()" class="text-gray-500 hover:text-gray-700">Tutup</button>
                </div>
            </div>

            <!-- Area Pengaturan Konten (Tampil setelah login) -->
            <div id="config-area" class="hidden space-y-8">
                <p class="text-green-600 font-semibold mb-4">Selamat datang, Admin! Anda dapat mengubah konten di bawah ini.</p>

                <!-- EDIT TENTANG KAMI -->
                <div>
                    <h4 class="text-xl font-semibold mb-3 text-gray-800">1. Teks Tentang Kami</h4>
                    <textarea id="edit-about-text" rows="4" class="w-full p-3 border border-gray-300 rounded-lg"></textarea>
                </div>

                <!-- EDIT SLIDESHOW -->
                <div>
                    <h4 class="text-xl font-semibold mb-3 text-gray-800 flex justify-between items-center">
                        2. Slideshow (Maks 3 Slides)
                        <button onclick="addSlideField()" class="bg-blue-500 text-white px-3 py-1 text-sm rounded-full hover:bg-blue-600 transition">Tambah Slide</button>
                    </h4>
                    <div id="slide-fields" class="space-y-4">
                        <!-- Input slides akan diisi di sini -->
                    </div>
                </div>

                <!-- EDIT PRODUK -->
                <div>
                    <h4 class="text-xl font-semibold mb-3 text-gray-800 flex justify-between items-center">
                        3. Produk
                        <button onclick="addProductField()" class="bg-blue-500 text-white px-3 py-1 text-sm rounded-full hover:bg-blue-600 transition">Tambah Produk</button>
                    </h4>
                    <div id="product-fields" class="space-y-6">
                        <!-- Input produk akan diisi di sini -->
                    </div>
                </div>

                <!-- EDIT KONTAK -->
                <div>
                    <h4 class="text-xl font-semibold mb-3 text-gray-800">4. Informasi Kontak</h4>
                    <div class="space-y-3">
                        <input type="text" id="edit-contact-email" placeholder="Email" class="w-full p-3 border border-gray-300 rounded-lg">
                        <input type="text" id="edit-contact-phone" placeholder="Nomor Telepon" class="w-full p-3 border border-gray-300 rounded-lg">
                        <textarea id="edit-contact-address" rows="2" placeholder="Alamat Toko" class="w-full p-3 border border-gray-300 rounded-lg"></textarea>
                    </div>
                </div>

                <!-- Tombol Simpan -->
                <button id="save-button" class="w-full main-color text-white px-5 py-3 rounded-lg font-bold text-lg hover:bg-pink-600 transition">Simpan Semua Perubahan</button>
                <button onclick="closeAdminModal()" class="w-full bg-gray-200 text-gray-800 px-5 py-2 rounded-lg font-semibold hover:bg-gray-300 transition">Tutup Panel</button>
            </div>
        </div>
    </div>

    <!-- Firebase Scripting (Type="module" untuk imports) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // setLogLevel('Debug'); // Opsional: Aktifkan untuk debugging
        
        // --- VARIABEL GLOBAL DARI LINGKUNGAN CANVAS (WAJIB DIGUNAKAN) ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-smargon-app';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        // Menggunakan array segmen path untuk konstruksi doc() yang lebih eksplisit
        const DB_PATH_SEGMENTS = ['artifacts', appId, 'public', 'data', 'smargon_config', 'website_data'];
        const ADMIN_PASSWORD = 'gustiulil'; // Kata sandi admin

        // --- INISIALISASI FIREBASE ---
        let app;
        let db;
        let auth;
        let userId = null;
        let isAuthReady = false;
        let isSaving = false;
        let currentSlideIndex = 0;
        let websiteData = {}; // Menyimpan data dari Firestore

        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
        } catch (error) {
            console.error("Kesalahan inisialisasi Firebase:", error);
            document.getElementById('loading-screen').innerHTML = '<p class="text-red-500">Gagal memuat aplikasi. Cek konfigurasi Firebase.</p>';
        }

        // --- AUTENTIKASI DAN SETUP UTAMA ---
        const setupAuth = async () => {
            try {
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) {
                console.error("Kesalahan otentikasi Firebase:", error);
            }
        };

        // Listener untuk perubahan status otentikasi
        onAuthStateChanged(auth, (user) => {
            if (user) {
                userId = user.uid;
            }
            isAuthReady = true;
            // Setelah auth siap, mulai dengarkan data
            if (db) {
                listenForDataChanges();
            }
            document.getElementById('admin-button').onclick = openAdminModal;
            document.getElementById('admin-button-mobile').onclick = openAdminModal;
        });

        // Panggil setup autentikasi
        setupAuth();


        // --- FIREBASE FIRESTORE REAL-TIME LISTENER ---

        /**
         * Mengatur listener real-time untuk data website.
         */
        const listenForDataChanges = () => {
            if (!isAuthReady || !db) return;

            console.log(`Mencoba memuat data publik dengan User ID: ${userId || 'Anonim'}`);
            console.log(`Path data: /${DB_PATH_SEGMENTS.join('/')}`);

            // Menggunakan spread operator untuk konstruksi doc() yang lebih eksplisit
            const docRef = doc(db, ...DB_PATH_SEGMENTS);
            
            onSnapshot(docRef, (docSnap) => {
                if (docSnap.exists()) {
                    websiteData = docSnap.data();
                    console.log("Data diterima dari Firestore:", websiteData);
                    renderWebsite(websiteData);
                    hideLoading();
                } else {
                    console.warn("Dokumen tidak ditemukan. Membuat data default.");
                    const defaultData = getDefaultData();
                    // Coba atur data default (SetDoc akan membuat dokumen jika tidak ada)
                    // Menggunakan spread operator di sini juga
                    setDoc(doc(db, ...DB_PATH_SEGMENTS), defaultData).then(() => {
                        websiteData = defaultData;
                        renderWebsite(websiteData);
                        hideLoading();
                    }).catch(error => {
                        console.error("Gagal membuat data default:", error);
                        document.getElementById('loading-screen').innerHTML = '<p class="text-red-500">Gagal menyimpan data default.</p>';
                    });
                }
            }, (error) => {
                console.error("Kesalahan onSnapshot:", error);
                document.getElementById('loading-screen').innerHTML = `<p class="text-red-500">Gagal memuat data: ${error.message}</p>`;
            });
        };

        const getDefaultData = () => ({
            about: "Selamat datang di Kue Smargon Tata Boga. Kami menyajikan macaron (smargon) buatan tangan dengan kualitas premium, rasa unik, dan desain yang cantik. Setiap gigitan adalah seni kuliner yang memanjakan lidah.",
            slides: [
                { title: "Smargon Terbaik di Kota", subtitle: "Rasa premium, bahan pilihan.", image: "https://placehold.co/1200x600/FFD7E4/FF99AA?text=SLIDE+1" },
                { title: "Kualitas Tata Boga", subtitle: "Dibuat oleh ahli kuliner bersertifikat.", image: "https://placehold.co/1200x600/E5CCFF/B591FF?text=SLIDE+2" },
                { title: "Pesan Sekarang!", subtitle: "Tersedia untuk pesta dan acara spesial.", image: "https://placehold.co/1200x600/CCFFDD/91FFB5?text=SLIDE+3" }
            ],
            products: [
                { name: "Smargon Klasik", description: "Rasa vanila dan cokelat yang tak lekang oleh waktu.", price: "Rp 15.000 / pcs", image: "https://placehold.co/400x300/F08080/FFFFFF?text=PRODUK+KLASIK" },
                { name: "Smargon Spesial Matcha", description: "Perpaduan unik teh hijau Jepang dan krim keju.", price: "Rp 18.000 / pcs", image: "https://placehold.co/400x300/90EE90/FFFFFF?text=PRODUK+MATCHA" },
                { name: "Smargon Buah Segar", description: "Varian rasa buah musiman seperti stroberi dan blueberry.", price: "Rp 20.000 / pcs", image: "https://placehold.co/400x300/ADD8E6/FFFFFF?text=PRODUK+BUAH" }
            ],
            contact: {
                email: "order@smargontataboga.com",
                phone: "+62 812-3456-7890",
                address: "Jl. Tata Boga No. 10, Jakarta Selatan, Indonesia"
            }
        });

        const hideLoading = () => {
            document.getElementById('loading-screen').classList.add('hidden');
        }


        // --- FUNGSI RENDER WEBSITE UTAMA ---

        /**
         * Merender seluruh konten website berdasarkan data yang dimuat.
         * @param {object} data - Objek data dari Firestore.
         */
        const renderWebsite = (data) => {
            if (!data) return;

            // 1. Render Slideshow
            const slideshowContainer = document.getElementById('slideshow-container');
            const slideDotsContainer = document.getElementById('slide-dots');
            slideshowContainer.innerHTML = '';
            slideDotsContainer.innerHTML = '';

            data.slides.forEach((slide, index) => {
                // Slide Item
                const slideEl = document.createElement('div');
                slideEl.className = `absolute inset-0 bg-cover bg-center transition-opacity duration-700 ease-in-out ${index === currentSlideIndex ? 'opacity-100' : 'opacity-0'}`;
                slideEl.style.backgroundImage = `url('${slide.image}')`;
                slideEl.innerHTML = `
                    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center text-center p-8">
                        <div class="text-white">
                            <h2 class="text-6xl font-extrabold mb-4">${slide.title}</h2>
                            <p class="text-2xl font-light">${slide.subtitle}</p>
                        </div>
                    </div>
                `;
                slideEl.setAttribute('data-index', index);
                slideshowContainer.appendChild(slideEl);

                // Dot Indicator
                const dotEl = document.createElement('span');
                dotEl.className = `w-3 h-3 rounded-full cursor-pointer transition-colors duration-300 ${index === currentSlideIndex ? 'main-color' : 'bg-white bg-opacity-50'}`;
                dotEl.onclick = () => showSlide(index);
                slideDotsContainer.appendChild(dotEl);
            });

            // 2. Render Produk
            const productList = document.getElementById('product-list');
            productList.innerHTML = data.products.map(p => `
                <div class="bg-white rounded-xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl hover:-translate-y-1">
                    <img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/400x300/cccccc/333333?text=NO+IMAGE'" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h3 class="text-2xl font-bold text-main-color mb-2">${p.name}</h3>
                        <p class="text-gray-600 mb-4">${p.description}</p>
                        <p class="text-3xl font-extrabold text-pink-700">${p.price}</p>
                    </div>
                </div>
            `).join('');

            // 3. Render Kontak
            const contactInfo = document.getElementById('contact-info');
            contactInfo.innerHTML = `
                <p class="flex items-center space-x-3"><span class="text-main-color">üìß</span> <span>Email: <a href="mailto:${data.contact.email}" class="hover:underline">${data.contact.email}</a></span></p>
                <p class="flex items-center space-x-3"><span class="text-main-color">üìû</span> <span>Telepon: <a href="tel:${data.contact.phone}" class="hover:underline">${data.contact.phone}</a></span></p>
                <p class="flex items-start space-x-3"><span class="text-main-color">üìç</span> <span>Alamat: ${data.contact.address}</span></p>
            `;

            // 4. Render Tentang Kami
            document.getElementById('about-text').innerText = data.about;
        };


        // --- FUNGSI SLIDESHOW ---

        /**
         * Menampilkan slide tertentu dan memperbarui indikator.
         * @param {number} n - Indeks slide yang akan ditampilkan.
         */
        window.showSlide = (n) => {
            const slides = document.querySelectorAll('#slideshow-container > div');
            const dots = document.querySelectorAll('#slide-dots > span');
            
            if (slides.length === 0) return;

            currentSlideIndex = (n + slides.length) % slides.length;
            
            slides.forEach((slide, index) => {
                const isCurrent = index === currentSlideIndex;
                slide.classList.toggle('opacity-100', isCurrent);
                slide.classList.toggle('opacity-0', !isCurrent);
                dots[index].classList.toggle('main-color', isCurrent);
                dots[index].classList.toggle('bg-white', isCurrent);
                dots[index].classList.toggle('bg-opacity-50', !isCurrent);
            });
        };

        /**
         * Mengubah slide relatif dari slide saat ini.
         * @param {number} n - Perubahan indeks (+1 atau -1).
         */
        window.changeSlide = (n) => {
            showSlide(currentSlideIndex + n);
        };

        // Otomatis pindah slide setiap 5 detik
        setInterval(() => {
            changeSlide(1);
        }, 5000);
        

        // --- FUNGSI ADMIN PANEL ---

        /**
         * Membuka modal admin.
         */
        const openAdminModal = () => {
            const modal = document.getElementById('admin-modal');
            const content = document.getElementById('admin-content');
            modal.classList.remove('hidden');
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);

            // Reset UI
            document.getElementById('auth-area').classList.remove('hidden');
            document.getElementById('config-area').classList.add('hidden');
            document.getElementById('auth-error').classList.add('hidden');
            document.getElementById('admin-password').value = '';
        };

        /**
         * Menutup modal admin.
         */
        window.closeAdminModal = () => {
            const modal = document.getElementById('admin-modal');
            const content = document.getElementById('admin-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        };

        /**
         * Mengisi form admin dengan data saat ini dari websiteData.
         */
        const populateAdminForm = (data) => {
            // 1. Tentang Kami
            document.getElementById('edit-about-text').value = data.about || '';

            // 2. Kontak
            document.getElementById('edit-contact-email').value = data.contact?.email || '';
            document.getElementById('edit-contact-phone').value = data.contact?.phone || '';
            document.getElementById('edit-contact-address').value = data.contact?.address || '';

            // 3. Slideshow
            const slideFieldsContainer = document.getElementById('slide-fields');
            slideFieldsContainer.innerHTML = '';
            data.slides.forEach((slide, index) => addSlideField(slide, index));

            // 4. Produk
            const productFieldsContainer = document.getElementById('product-fields');
            productFieldsContainer.innerHTML = '';
            data.products.forEach((product, index) => addProductField(product, index));
        };

        /**
         * Menambahkan baris input untuk satu slide.
         */
        window.addSlideField = (slide = {}, index = document.getElementById('slide-fields').children.length) => {
            const container = document.getElementById('slide-fields');
            const div = document.createElement('div');
            div.className = 'p-4 border rounded-lg bg-pink-50 relative';
            div.innerHTML = `
                <h5 class="font-semibold mb-2">Slide ${index + 1}</h5>
                <input type="text" placeholder="Judul Slide" value="${slide.title || ''}" data-type="slide-title" data-index="${index}" class="w-full p-2 mb-2 border rounded-lg">
                <input type="text" placeholder="Sub-judul Slide" value="${slide.subtitle || ''}" data-type="slide-subtitle" data-index="${index}" class="w-full p-2 mb-2 border rounded-lg">
                <input type="text" placeholder="URL Gambar (Contoh: https://placehold.co/1200x600/...)" value="${slide.image || ''}" data-type="slide-image" data-index="${index}" class="w-full p-2 mb-2 border rounded-lg">
                <button onclick="removeField(this, 'slide')" class="absolute top-2 right-2 text-red-500 hover:text-red-700 font-bold text-lg leading-none">√ó</button>
            `;
            container.appendChild(div);
        };

        /**
         * Menambahkan baris input untuk satu produk.
         */
        window.addProductField = (product = {}, index = document.getElementById('product-fields').children.length) => {
            const container = document.getElementById('product-fields');
            const div = document.createElement('div');
            div.className = 'p-4 border rounded-lg bg-gray-50 relative';
            div.innerHTML = `
                <h5 class="font-semibold mb-2">Produk ${index + 1}</h5>
                <input type="text" placeholder="Nama Produk" value="${product.name || ''}" data-type="product-name" data-index="${index}" class="w-full p-2 mb-2 border rounded-lg">
                <input type="text" placeholder="Harga (Contoh: Rp 15.000 / pcs)" value="${product.price || ''}" data-type="product-price" data-index="${index}" class="w-full p-2 mb-2 border rounded-lg">
                <textarea rows="2" placeholder="Deskripsi Produk" data-type="product-description" data-index="${index}" class="w-full p-2 mb-2 border rounded-lg">${product.description || ''}</textarea>
                <input type="text" placeholder="URL Gambar Produk (Contoh: https://placehold.co/400x300/...)" value="${product.image || ''}" data-type="product-image" data-index="${index}" class="w-full p-2 mb-2 border rounded-lg">
                <button onclick="removeField(this, 'product')" class="absolute top-2 right-2 text-red-500 hover:text-red-700 font-bold text-lg leading-none">√ó</button>
            `;
            container.appendChild(div);
        };

        /**
         * Menghapus baris input field (slide atau produk).
         */
        window.removeField = (button, type) => {
            const field = button.closest('div');
            field.remove();
        };

        // Event listener untuk tombol Login
        document.getElementById('login-button').addEventListener('click', () => {
            const passwordInput = document.getElementById('admin-password');
            const errorText = document.getElementById('auth-error');
            
            if (passwordInput.value === ADMIN_PASSWORD) {
                // Login berhasil
                errorText.classList.add('hidden');
                document.getElementById('auth-area').classList.add('hidden');
                document.getElementById('config-area').classList.remove('hidden');
                populateAdminForm(websiteData);
            } else {
                // Login gagal
                errorText.classList.remove('hidden');
            }
        });

        // Event listener untuk tombol Simpan
        document.getElementById('save-button').addEventListener('click', async () => {
            if (isSaving) return;
            isSaving = true;
            document.getElementById('save-button').innerText = 'Menyimpan...';

            const newContact = {
                email: document.getElementById('edit-contact-email').value,
                phone: document.getElementById('edit-contact-phone').value,
                address: document.getElementById('edit-contact-address').value,
            };

            const newAbout = document.getElementById('edit-about-text').value;

            // Kumpulkan data Slides
            const newSlides = Array.from(document.getElementById('slide-fields').children).map(field => {
                return {
                    title: field.querySelector('[data-type="slide-title"]').value,
                    subtitle: field.querySelector('[data-type="slide-subtitle"]').value,
                    image: field.querySelector('[data-type="slide-image"]').value,
                };
            }).filter(slide => slide.title); // Hanya simpan yang memiliki judul

            // Kumpulkan data Produk
            const newProducts = Array.from(document.getElementById('product-fields').children).map(field => {
                return {
                    name: field.querySelector('[data-type="product-name"]').value,
                    price: field.querySelector('[data-type="product-price"]').value,
                    description: field.querySelector('[data-type="product-description"]').value,
                    image: field.querySelector('[data-type="product-image"]').value,
                };
            }).filter(product => product.name); // Hanya simpan yang memiliki nama

            const newData = {
                about: newAbout,
                contact: newContact,
                slides: newSlides,
                products: newProducts
            };

            try {
                // Menggunakan spread operator untuk setDoc
                await setDoc(doc(db, ...DB_PATH_SEGMENTS), newData);
                alertCustom('Perubahan berhasil disimpan!', 'success');
                closeAdminModal();
            } catch (e) {
                console.error("Kesalahan menyimpan dokumen:", e);
                alertCustom(`Gagal menyimpan perubahan: ${e.message}`, 'error');
            } finally {
                isSaving = false;
                document.getElementById('save-button').innerText = 'Simpan Semua Perubahan';
            }
        });

        // --- FUNGSI CUSTOM ALERT (Pengganti alert() bawaan) ---
        
        /**
         * Menampilkan pesan notifikasi kustom.
         * @param {string} message - Pesan yang akan ditampilkan.
         * @param {string} type - Tipe notifikasi ('success' atau 'error').
         */
        const alertCustom = (message, type) => {
            const existingAlert = document.getElementById('custom-alert');
            if (existingAlert) existingAlert.remove();

            const bgColor = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            const alertDiv = document.createElement('div');
            alertDiv.id = 'custom-alert';
            alertDiv.className = `fixed top-4 right-4 ${bgColor} text-white p-4 rounded-lg shadow-xl z-[100] transition-opacity duration-300 opacity-0`;
            alertDiv.innerText = message;
            
            document.body.appendChild(alertDiv);
            
            // Tampilkan alert
            setTimeout(() => {
                alertDiv.classList.remove('opacity-0');
            }, 10);

            // Sembunyikan dan hapus setelah 3 detik
            setTimeout(() => {
                alertDiv.classList.add('opacity-0');
                setTimeout(() => {
                    alertDiv.remove();
                }, 300);
            }, 3000);
        };
    </script>
</body>
</html>
